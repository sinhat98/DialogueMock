from src.modules.dialogue.utils import constants

tts_label2text = {
    "SELECT": "ご用件をお話しください。",
    "INITIAL": "お電話ありがとうございます。SHIFT渋谷店でございます。",
    constants.FILLER: "確認いたします",
    constants.APLOGIZE: "申し訳ございません、うまく聞き取れませんでした",
    "DATE_1": "ご希望の日付をお伺いしてもよろしいでしょうか？",
    "TIME_1": "ご希望の時間をお伺いしてもよろしいでしょうか？",
    "N_PERSON_1": "ご来店人数をお伺いしてもよろしいでしょうか？",
    "NAME_1": "ご来店される代表者のお名前をお伺いしてもよろしいでしょうか？",
}

tts_text2label = {t: l for l, t in tts_label2text.items()}

intents = {
    "新規予約": [
        "予約したい", 
        "予約をお願いします", 
        "新しく予約を取りたい",
        "テーブルを予約したい"
    ],
    "予約内容の確認": [
        "予約を確認したい",
        "予約の内容を教えてください",
        "予約の詳細を知りたい",
        "予約状況を確認したい"
    ],
    "予約のキャンセル": [
        "予約をキャンセルしたい",
        "予約を取り消したい",
        "予約を取り消し",
        "キャンセルをお願いします"
    ],
    "店舗についての質問": [
        "店舗の場所を教えてください",
        "営業時間は何時までですか",
        "定休日を教えてください",
        "駐車場はありますか"
    ]
}

templates = {
    "initial_state": {
        "名前": "",
        "日付": "",
        "時間": "",
        "人数": "",
    },

    "scenes": {
        "新規予約": {
            "required_slots": ["日付", "時間", "人数", "名前"],
            "optional_slots": [],
            "prompts": {
                "日付": ("ご希望の日付をお伺いしてもよろしいでしょうか？", "DATE_1"),
                "時間": ("ご希望の時間をお伺いしてもよろしいでしょうか？", "TIME_1"),
                "人数": ("ご来店人数をお伺いしてもよろしいでしょうか？", "N_PERSON_1"),
                "名前": ("ご来店される代表者のお名前をお伺いしてもよろしいでしょうか？", "NAME_1"),
            },
            "responses": {
                "COMPLETE": "承知いたしました。{日付}の{時間}に{人数}名様で{名前}様のご予約を承りました。",
            },
            "implicit_confirmation": {
                frozenset(["日付", "時間", "人数"]): "{日付}の{時間}に{人数}名様ですね。",
                frozenset(["日付", "時間"]): "{日付}の{時間}ですね。",
                frozenset(["日付", "人数"]): "{日付}に{人数}名様ですね。",
                frozenset(["時間", "人数"]): "{時間}に{人数}名様ですね。",
                "名前": "{名前}様ですね。",
                "日付": "{日付}ですね。",
                "時間": "{時間}ですね。",
                "人数": "{人数}名様ですね。",
            },
            "correction": {
                "日付": ("ご希望の日付を改めてお伺いいたします。", "DATE_2"),
                "時間": ("ご希望の時間を改めてお伺いいたします。", "TIME_2"),
                "人数": ("ご来店人数を改めてお伺いいたします。", "N_PERSON_2"),
                "名前": ("代表者のお名前を改めてお伺いいたします。", "NAME_2"),
            },
        },

        "予約内容の確認": {
            "required_slots": ["名前"],
            "optional_slots": ["日付"],
            "prompts": {
                "名前": ("ご予約者のお名前をお伺いできますでしょうか？", "CONFIRM_NAME_1"),
                "日付": ("ご予約の日付は分かりますでしょうか？", "CONFIRM_DATE_1"),
            },
            "responses": {
                "COMPLETE": "{名前}様の{日付}のご予約を確認いたしました。",
                "NOT_FOUND": "申し訳ございません。{名前}様のご予約は見つかりませんでした。",
            },
            "implicit_confirmation": {
                "名前": "{名前}様のご予約ですね。",
                "日付": "{日付}のご予約ですね。",
            },
        },

        "予約のキャンセル": {
            "required_slots": ["名前"],
            "optional_slots": ["日付"],
            "prompts": {
                "名前": ("キャンセルされるご予約のお名前をお伺いできますでしょうか？", "CANCEL_NAME_1"),
            },
            "responses": {
                "COMPLETE": "{名前}様のご予約をキャンセルいたしました。",
                "NOT_FOUND": "申し訳ございません。{名前}様のご予約は見つかりませんでした。",
            },
            "implicit_confirmation": {
                "名前": "{名前}様のご予約のキャンセルですね。",
            },
        },

        "店舗についての質問": {
            "required_slots": [],
            "optional_slots": [],
            "responses": {
                "COMPLETE": "ご質問ありがとうございます。",
            },
        },
    },

    "common": {
        "fallback": {
            "INVALID_INTENT": "申し訳ございません。ご要件を理解できませんでした。",
            "NO_INTENT_DETECTED": "申し訳ございません。もう一度ご要件をお聞かせください。",
            "CONVERSATION_ERROR": "申し訳ございません。対応できない状況が発生しました。",
            "DEFAULT": "申し訳ございません。",
        },
        "scene_initial": {
            "新規予約": "ご予約ですね。承知いたしました。",
            "予約内容の確認": "ご予約の確認ですね。",
            "予約のキャンセル": "ご予約のキャンセルですね。",
            "店舗についての質問": "店舗についてのご質問ですね。",
        },
        "scene_complete": {
            "新規予約": "ご予約ありがとうございました。当日のご来店をお待ちしております。",
            "予約内容の確認": "ご予約内容のご確認は以上です。",
            "予約のキャンセル": "ご予約のキャンセルが完了いたしました。またのご利用をお待ちしております。",
            "店舗についての質問": "ご質問は以上でよろしいでしょうか。",
        }
    }
}